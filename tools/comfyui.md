# ComfyUI — рекомендации по использованию

ComfyUI MCP (`http://127.0.0.1:9000/mcp`) — генерация визуальных ассетов: спрайты, текстуры, фоны, UI-иконки.

---

## Предварительные требования

- ComfyUI запущен (обычно `:8188`).
- comfyui-mcp-server запущен на `:9000`.
- В `.cursor/mcp.json` настроен `"comfyui": { "url": "http://127.0.0.1:9000/mcp" }`.

---

## Типовой воркфлоу

```
1. Определить что нужно (спрайт, фон, иконка)
2. Сформировать промпт (описание + стиль + размер)
3. Вызвать ComfyUI MCP
4. Проверить результат
5. Сохранить в Assets/Art/[подпапка]/
6. Настроить Import Settings в Unity (Sprite Mode, PPU, Filter Mode)
7. Refresh Assets через Unity MCP
```

---

## Правила промптов

### Общие принципы

- **Один стиль на проект** — решить стиль в начале и использовать одинаковый префикс для всех промптов.
- **Конкретность** — вместо «красивый персонаж» писать «knight in blue armor, side view, pixel art, 64x64».
- **Фон** — для спрайтов/иконок всегда указывать `transparent background` (или конкретный цвет).
- **Размер** — указывать явно: `64x64`, `128x128`, `256x256`, `512x512`.

### Шаблоны промптов

**Спрайт персонажа:**
```
[описание персонажа], [поза/вид: side view / front view / idle pose],
[стиль: pixel art / cartoon / hand-drawn / low-poly],
[размер: 64x64 / 128x128], transparent background
```

**Фон / окружение:**
```
[описание: forest background / dungeon tileset / sky gradient],
[стиль], [seamless tileable] (если нужен тайл),
[размер: 512x512 / 1920x1080], [цветовая палитра: warm / cold / neon]
```

**UI иконка:**
```
[описание: sword icon / health potion / coin],
flat icon, simple, [стиль],
[размер: 32x32 / 48x48 / 64x64], transparent background
```

**Набор тайлов:**
```
tileset for [тип: platformer / top-down RPG / dungeon],
[стиль], [содержимое: grass, dirt, stone, water],
each tile [размер: 32x32 / 64x64], transparent background
```

### Стиль-префиксы (примеры)

| Стиль | Префикс для промпта |
|-------|---------------------|
| Пиксель-арт | `pixel art, retro, limited color palette, crisp edges` |
| Cartoon | `cartoon style, bold outlines, vibrant colors, cel-shaded` |
| Минимализм | `minimalist, flat design, simple shapes, pastel colors` |
| Hand-drawn | `hand-drawn, sketch style, watercolor, organic lines` |
| Low-poly 3D (рендер) | `low-poly 3D render, isometric, soft lighting, minimal textures` |

---

## Использование по режимам

### Прототип

- **Не нужен.** Использовать плейсхолдеры (цветные квадраты, примитивы Unity).
- Если хочется — максимум 1–2 ассета для настроения.
- Не тратить время на подбор стиля.

### Стандартный

- **По желанию.** Генерировать ключевые ассеты: спрайт персонажа, базовые враги, фон.
- Определить стиль-префикс в начале — использовать его для всех ассетов.
- Иконки UI — если есть время.
- **Момент:** после реализации фичи, перед следующей (или отдельным этапом «Арт»).

### Быстрый

- **По желанию, но не обязательно.** Если нужны ассеты — генерировать пакетом (несколько за раз).
- Плейсхолдеры приемлемы до финальной полировки.
- Не тратить время на итерации — первый приемлемый результат = ок.

### Профи

- **Рекомендуется полноценно.** Все визуальные ассеты через генерацию.
- Определить стиль-гайд (style guide) в начале:
  - Стиль-префикс для промптов.
  - Цветовая палитра.
  - Размеры по типам ассетов.
- Итерации: генерировать несколько вариантов, выбирать лучший.
- Отдельный этап «Арт» в плане разработки.
- Документировать промпты в DEV_STATE (чтобы регенерировать при необходимости).

---

## Import Settings в Unity

После сохранения ассета в `Assets/Art/` — настроить:

| Параметр | Спрайт | Фон | Иконка UI |
|----------|--------|-----|-----------|
| Texture Type | Sprite (2D and UI) | Sprite или Default | Sprite (2D and UI) |
| Sprite Mode | Single | Single | Single |
| Pixels Per Unit | 64 (для pixel art) / 100 | 100 | 100 |
| Filter Mode | Point (pixel art) / Bilinear | Bilinear | Bilinear |
| Compression | None (pixel art) / Normal | Normal | None |

---

## Fallback при недоступности

Если ComfyUI не запущен или не генерирует:

1. Использовать **плейсхолдеры** — цветные спрайты, примитивы Unity (квадрат, круг).
2. Продолжить разработку — арт не блокирует код.
3. Вернуться к генерации позже, когда ComfyUI доступен.
4. Пометить в DEV_STATE: «Арт: плейсхолдеры, заменить на сгенерированные».
